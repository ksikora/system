<script type="text/javascript">
var query = window.location.search;
  // Skip the leading ?, which should always be there, 
  // but be careful anyway
  if (query.substring(0, 1) == '?') {
    query = query.substring(1);
  }
  var data = query.split(','); 
//  alert(query);
</script>

<script type="text/javascript">

function makeitsnow() { running = !running;}
var running = true;
var d;
var d2;
function get_data(xx) {
//tutaj URL bedzie trzeba przerobic - jako argument powinien dostawac ID urzadzenia do monitorowaniwania
$.get('/get_data_from_c?x='+xx, function(data){
tmp = data.split(" ");
d1 = parseFloat(tmp[0]);
d2 = parseFloat(tmp[1]);
d = Array();
d.push(d1);
d.push(d2);
});
return d;
};


Highcharts.setOptions({
global: {
useUTC: false
}
});


var plotting = true;
var chart;
var xx = 0.0;
$(document).ready(function() {
   chart = new Highcharts.Chart({
      chart: {
         renderTo: 'chart_container',
         animation: false,
         marginRight: 10,
         events: {
            load: function() {
                   
                    // set up the updating of the chart every 0.2 seconds
                         var series = this.series[0];
                         var series2 = this.series[1];
                         setInterval(function() {
                         var x = (new Date()).getTime(), // current time
                         
										     
     										 y = get_data(xx);
     										 //y = Math.random(1)
										     if(typeof(y[0]) == undefined)
										     {
										     	 y[0] = 0;
										     }
                         //y = Math.sin(xx);
                         
                      	 xx = xx+ 0.1;
                      	 if(running)
                         {
                            	 series.addPoint([x, y[0]], true, true);
                            	 series2.addPoint([x, y[1]], true, true); 
                         }
               }, 100);
            }
         }
      },
      title: {
         text: 'Live Load data'
      },
      xAxis: {
         type: 'datetime',
         tickPixelInterval: 10,
				 labels: {
				 		enabled: false
				 }
      },
      yAxis: {
         title: {
            text: 'Value'
         },
         plotLines: [{
            value: 0,
            width: 1,
            color: '#808080'
         }]
      },
      tooltip: {
				 enabled: true,
         formatter: function() {
               return Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) +'<br/>'+ Highcharts.numberFormat(this.y, 2);
         }
      },
      
      legend: {
         enabled: true
      },
      exporting: {
         enabled: false
      },
      plotOptions:{
        area: {
          animation: false
        },
        line: {
          animation: false,
          shadow: false
        },
        gauge: {
          animation: false
        },
      	spline: {
      		animation: false
      	}
      },
      
      series: [{
         name: 'Random data',
         data: (function() {
            // generate an array of random data
            var data = [],
               time = (new Date()).getTime(),
               i;
            for (i = -50; i <= 0; i++) {
               data.push({
                  x: time + i * 1000,
                  y: 0
               });
            }
            return data;
         })()
      },
      {
         name: 'Random data',
         data: (function() {
            // generate an array of random data
            var data = [],
               time = (new Date()).getTime(),
               i;
            for (i = -50; i <= 0; i++) {
               data.push({
                  x: time + i * 1000,
                  y: 0
               });
            }
            return data;
         })()
      }]
   });
   
   
});
</script>


<button onclick="makeitsnow();">Start/Stop</button>



<div id="chart_container" style="width: 100%; height: 400px"></div>

